var username=$("#username").val(),lessonNo=$("#lessonNo").val(),PAGE_SIZE=50,no=1,orderBy=0,learnedChart=c3.generate({bindto:"#learnedChart",data:{types:{Rate:"bar"},columns:[],colors:{Rate:"#49A5F8"}},axis:{x:{label:{text:"Starting Time",position:"outer-right"},type:"category",tick:{rotate:-35,multiline:!1},height:85},y:{label:{text:"Accuracy Rate(%)",position:"outer-top"},tick:{format:function(e){return e<=100?e:""}},padding:{top:100,bottom:100}}},grid:{y:{show:!0}}});$(function(){getLessonLearnedRecord(PAGE_SIZE,no),$(".icon-more",".learned-record").on("click",function(){getLessonLearnedRecord(PAGE_SIZE,++no,orderBy,!1)});var e=!1,t=!1,a=!1;$(".sort-by-time").on("click",function(){no=1,e?($(this).find(".el-icon-caret-top").addClass("active").siblings().removeClass("active"),e=!1,getLessonLearnedRecord(PAGE_SIZE,no,orderBy=101)):($(this).find(".el-icon-caret-bottom").addClass("active").siblings().removeClass("active"),e=!0,getLessonLearnedRecord(PAGE_SIZE,no,orderBy=1))}),$(".sort-by-rate").on("click",function(){no=1,t?($(this).find(".el-icon-caret-top").addClass("active").siblings().removeClass("active"),t=!1,getLessonLearnedRecord(PAGE_SIZE,no,orderBy=102)):($(this).find(".el-icon-caret-bottom").addClass("active").siblings().removeClass("active"),t=!0,getLessonLearnedRecord(PAGE_SIZE,no,orderBy=2))}),$(".sort-by-score").on("click",function(){no=1,a?($(this).find(".el-icon-caret-top").addClass("active").siblings().removeClass("active"),a=!1,getLessonLearnedRecord(PAGE_SIZE,no,orderBy=103)):($(this).find(".el-icon-caret-bottom").addClass("active").siblings().removeClass("active"),a=!0,getLessonLearnedRecord(PAGE_SIZE,no,orderBy=3))})});var flag=!1,accuracyRateArray=["Rate"],startTimeArray=[],getLessonLearnedRecord=function(e,i,t,c){if(flag)return!1;c=void 0===c||c,$.get(LESSON_API+"/api/record/detail",{username:username,lessonNo:lessonNo,psize:e,pno:i,order:t},function(e){var t=e.data,a=e.page;if(i>=a.totalPage&&$(".icon-more",".learned-record").hide(),"{}"==JSON.stringify(e.data)&&(flag=!0),"{}"!=JSON.stringify(e.data)&&0==e.err){var r=$(".tbl-learned-record");c&&(r.html(""),accuracyRateArray=["Rate"],startTimeArray=[]),$(".learned-times").text(a.totalCount),$(".lesson-no").text(t[0].lessonNo),$(".lesson-title").text(t[0].lessonTitle);for(var o=0;o<t.length;o++){var n=t[o];n.accuracyRate=n.rightCount/(n.rightCount+n.emptyCount+n.wrongCount),n.accuracyRate=n.accuracyRate?Number(100*n.accuracyRate).toFixed(1):0;var s=new Date(n.beginTime).format("hh:mm dd/MM/yyyy");accuracyRateArray.push(n.accuracyRate),startTimeArray.push(s),r.append("<tr>    <td>"+((a.pageNo-1)*a.pageSize+o+1)+"</td>    <td>"+s+"</td>    <td>"+n.accuracyRate+"%</td>    <td>"+(n.totalScore?n.totalScore:0)+'</td>    <td> <a href="/learnedRecord/'+n.sn+'" class="el-button el-button--primary el-button--mini">            View Details</a></td></tr>')}learnedChart.load({columns:[accuracyRateArray],categories:startTimeArray})}})};